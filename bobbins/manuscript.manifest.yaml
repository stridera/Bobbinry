id: manuscript
name: Manuscript
version: 1.0.0
author: "Bobbins Core"
description: "Chapters, scenes, and narrative structure with outline and editor views."
tags: [writing, narrative, structure]
license: MIT
capabilities:
  publishable: true
  external: false
  ai: false
  customViews: false
execution:
  mode: native
  signature: dev_mode_skip
data:
  collections:
    - name: Book
      fields:
        - { name: title, type: text, required: true }
        - { name: subtitle, type: text }
        - { name: slug, type: text }
        - { name: synopsis, type: text }
        - { name: status, type: text }
        - { name: word_count, type: number }
      relationships:
        - { name: chapters, type: one-to-many, target: Chapter }
    - name: Chapter
      fields:
        - { name: title, type: text, required: true }
        - { name: synopsis, type: text }
        - { name: order, type: number }
        - { name: status, type: text }
        - { name: pov, type: text }
        - { name: tags, type: json }
        - { name: word_count, type: number }
      relationships:
        - { name: book, type: one-to-one, target: Book }
        - { name: scenes, type: one-to-many, target: Scene }
    - name: Scene
      fields:
        - { name: title, type: text, required: true }
        - { name: body, type: markdown }
        - { name: synopsis, type: text }
        - { name: order, type: number }
        - { name: pov, type: text }
        - { name: status, type: text }
        - { name: tags, type: json }
        - { name: word_count, type: number }
      relationships:
        - { name: chapter, type: one-to-one, target: Chapter }
        - { name: links, type: many-to-many, target: Location }
ui:
  views:
    - id: outline
      name: Outline
      type: tree
      source: Chapter
      layout:
        root: Book
        children: scenes
        display:
          title: title
          subtitle: synopsis
        actions:
          - create_chapter
          - create_scene
          - reorder
    - id: editor
      name: Editor
      type: editor
      source: Scene
      layout:
        field: body
        sidebar:
          show: [synopsis, pov, status, tags, word_count]
        features:
          - link_mentions
          - wordcount_live
          - history
interactions:
  actions:
    - id: create_chapter
      name: Create Chapter
      type: create
      target: Chapter
    - id: create_scene
      name: Create Scene
      type: create
      target: Scene
    - id: validate_wordcount
      name: Validate Word Count
      type: custom
      target: Scene
  triggers:
    - id: on_scene_save
      event: update
      actions:
        - validate_wordcount
external: null
linking:
  entities:
    - collection: Chapter
      display:
        template: "{{title}}"
    - collection: Scene
      display:
        template: "{{title}}"
publish:
  entities: [Book, Chapter, Scene]
  fields: [title, body, synopsis, order, status, word_count]
  output:
    - format: html
      template: book
    - format: json
    - format: markdown
compatibility:
  minShellVersion: 1.0.0
  migrations: []
